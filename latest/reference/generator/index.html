
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Software for Relative Binding Free Energy calculations">
      
      
      
        <link rel="canonical" href="https://github.com/UCL-CCS/TIES/latest/reference/generator/">
      
      
        <link rel="prev" href="../config/">
      
      
        <link rel="next" href="../helpers/">
      
      
      <link rel="icon" href="../../images/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.1">
    
    
      
        <title>generator - TIES</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ties.generator" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TIES" class="md-header__button md-logo" aria-label="TIES" data-md-component="logo">
      
  <img src="../../images/favicon-32x32.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TIES
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> generator
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/UCL-CCS/TIES" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    UCL-CCS/TIES
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../usage/" class="md-tabs__link">
        
  
    
  
  Usage

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  API reference

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/" class="md-tabs__link">
          
  
    
  
  Theory

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TIES" class="md-nav__button md-logo" aria-label="TIES" data-md-component="logo">
      
  <img src="../../images/favicon-32x32.png" alt="logo">

    </a>
    TIES
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UCL-CCS/TIES" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    UCL-CCS/TIES
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_1" id="__nav_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../webties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WebTIES
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ties
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_1" id="__nav_3_1_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ties
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> generator
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> generator
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ties.generator.join_frcmod_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;join_frcmod_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.correct_fep_tempfactor" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;correct_fep_tempfactor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.get_PBC_coords" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_PBC_coords
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.extract_PBC_oct_from_tleap_log" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;extract_PBC_oct_from_tleap_log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.prepare_antechamber_parmchk2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_antechamber_parmchk2
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_antechamber_parmchk2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ties.generator.prepare_antechamber_parmchk2--fixme-run-antechamber-directly-with-the-right-settings-from-here" class="md-nav__link">
    <span class="md-ellipsis">
      fixme - run antechamber directly with the right settings from here?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.prepare_antechamber_parmchk2--fixme-check-if-antechamber-has-a-python-interface" class="md-nav__link">
    <span class="md-ellipsis">
      fixme - check if antechamber has a python interface?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.get_protein_net_charge" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_protein_net_charge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.prepareFile" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepareFile
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_coor_from_ref_by_named_pairs
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" set_coor_from_ref_by_named_pairs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--flip-the-first-ring" class="md-nav__link">
    <span class="md-ellipsis">
      flip the first ring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--move-the-first-c-and-its-h" class="md-nav__link">
    <span class="md-ellipsis">
      move the first c and its h
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--second-pair" class="md-nav__link">
    <span class="md-ellipsis">
      second pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--the-actual-matching-pair" class="md-nav__link">
    <span class="md-ellipsis">
      the actual matching pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--the-second-matching-pair" class="md-nav__link">
    <span class="md-ellipsis">
      the second matching pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--flip-the-other-ring-with-itself" class="md-nav__link">
    <span class="md-ellipsis">
      flip the other ring with itself
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.update_PBC_in_namd_input" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_PBC_in_namd_input
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.create_constraint_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_constraint_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.init_namd_file_min" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_namd_file_min
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.generate_namd_prod" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_namd_prod
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.generate_namd_eq" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_namd_eq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.redistribute_charges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;redistribute_charges
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ligand/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ligand
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ligandmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ligandmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../md/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> md
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../namd_generator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> namd_generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pair/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> pair
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protein/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> protein
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topology_superimposer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> topology_superimposer
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../superimposition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Superimposition
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ties.generator.join_frcmod_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;join_frcmod_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.correct_fep_tempfactor" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;correct_fep_tempfactor
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.get_PBC_coords" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_PBC_coords
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.extract_PBC_oct_from_tleap_log" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;extract_PBC_oct_from_tleap_log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.prepare_antechamber_parmchk2" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepare_antechamber_parmchk2
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" prepare_antechamber_parmchk2">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ties.generator.prepare_antechamber_parmchk2--fixme-run-antechamber-directly-with-the-right-settings-from-here" class="md-nav__link">
    <span class="md-ellipsis">
      fixme - run antechamber directly with the right settings from here?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.prepare_antechamber_parmchk2--fixme-check-if-antechamber-has-a-python-interface" class="md-nav__link">
    <span class="md-ellipsis">
      fixme - check if antechamber has a python interface?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.get_protein_net_charge" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;get_protein_net_charge
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.prepareFile" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;prepareFile
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;set_coor_from_ref_by_named_pairs
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" set_coor_from_ref_by_named_pairs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--flip-the-first-ring" class="md-nav__link">
    <span class="md-ellipsis">
      flip the first ring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--move-the-first-c-and-its-h" class="md-nav__link">
    <span class="md-ellipsis">
      move the first c and its h
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--second-pair" class="md-nav__link">
    <span class="md-ellipsis">
      second pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--the-actual-matching-pair" class="md-nav__link">
    <span class="md-ellipsis">
      the actual matching pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--the-second-matching-pair" class="md-nav__link">
    <span class="md-ellipsis">
      the second matching pair
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--_1" class="md-nav__link">
    <span class="md-ellipsis">
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.generator.set_coor_from_ref_by_named_pairs--flip-the-other-ring-with-itself" class="md-nav__link">
    <span class="md-ellipsis">
      flip the other ring with itself
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.update_PBC_in_namd_input" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;update_PBC_in_namd_input
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.create_constraint_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_constraint_files
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.init_namd_file_min" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;init_namd_file_min
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.generate_namd_prod" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_namd_prod
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.generate_namd_eq" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_namd_eq
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ties.generator.redistribute_charges" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;redistribute_charges
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="ties.generator" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">generator</span>


</h1>

    <div class="doc doc-contents first">









<p><span class="doc-section-title">Functions:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.join_frcmod_files" href="#ties.generator.join_frcmod_files">join_frcmod_files</a></code></b>
            –
            <div class="doc-md-description">
              <p>This implementation should be used. Switch to join_frcmod_files2.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.correct_fep_tempfactor" href="#ties.generator.correct_fep_tempfactor">correct_fep_tempfactor</a></code></b>
            –
            <div class="doc-md-description">
              <p>fixme - this function does not need to use the file?</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.get_PBC_coords" href="#ties.generator.get_PBC_coords">get_PBC_coords</a></code></b>
            –
            <div class="doc-md-description">
              <p>Return [x, y, z]</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.extract_PBC_oct_from_tleap_log" href="#ties.generator.extract_PBC_oct_from_tleap_log">extract_PBC_oct_from_tleap_log</a></code></b>
            –
            <div class="doc-md-description">
              <p>http://ambermd.org/namd/namd_amber.html</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.prepare_antechamber_parmchk2" href="#ties.generator.prepare_antechamber_parmchk2">prepare_antechamber_parmchk2</a></code></b>
            –
            <div class="doc-md-description">
              <p>Prepare the ambertools scripts.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.get_protein_net_charge" href="#ties.generator.get_protein_net_charge">get_protein_net_charge</a></code></b>
            –
            <div class="doc-md-description">
              <p>Use automatic ambertools solvation of a single component to determine what is the next charge of the system.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.prepareFile" href="#ties.generator.prepareFile">prepareFile</a></code></b>
            –
            <div class="doc-md-description">
              <p>Either copies or sets up a relative link between the files.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.set_coor_from_ref_by_named_pairs" href="#ties.generator.set_coor_from_ref_by_named_pairs">set_coor_from_ref_by_named_pairs</a></code></b>
            –
            <div class="doc-md-description">
              <p>Set coordinates but use atom names provided by the user.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.update_PBC_in_namd_input" href="#ties.generator.update_PBC_in_namd_input">update_PBC_in_namd_input</a></code></b>
            –
            <div class="doc-md-description">
              <p>fixme - rename this file since it generates the .eq files</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.create_constraint_files" href="#ties.generator.create_constraint_files">create_constraint_files</a></code></b>
            –
            <div class="doc-md-description">
              <p>:param original_pdb:</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.init_namd_file_min" href="#ties.generator.init_namd_file_min">init_namd_file_min</a></code></b>
            –
            <div class="doc-md-description">
              <p>:param from_dir:</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.generate_namd_prod" href="#ties.generator.generate_namd_prod">generate_namd_prod</a></code></b>
            –
            <div class="doc-md-description">
              <p>:param namd_prod:</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.generate_namd_eq" href="#ties.generator.generate_namd_eq">generate_namd_eq</a></code></b>
            –
            <div class="doc-md-description">
              <p>:param namd_eq:</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="ties.generator.redistribute_charges" href="#ties.generator.redistribute_charges">redistribute_charges</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate the original charges in the matched component.</p>
            </div>
          </li>
    </ul>





  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="ties.generator.join_frcmod_files" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">join_frcmod_files</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">join_frcmod_files</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">output_filepath</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>This implementation should be used. Switch to join_frcmod_files2.
This version might be removed if the simple approach is fine.</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">join_frcmod_files</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">output_filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This implementation should be used. Switch to join_frcmod_files2.</span>
<span class="sd">    This version might be removed if the simple approach is fine.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># fixme - load f1 and f2</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_section</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">rlines</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Chips away from the lines until the section is ready</span>

<span class="sd">        fixme is there a .frcmod reader in ambertools?</span>
<span class="sd">        http://ambermd.org/FileFormats.php#frcmod</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">section_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MASS&#39;</span><span class="p">,</span> <span class="s1">&#39;BOND&#39;</span><span class="p">,</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIHE&#39;</span><span class="p">,</span> <span class="s1">&#39;IMPROPER&#39;</span><span class="p">,</span> <span class="s1">&#39;NONBON&#39;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">rlines</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

        <span class="n">section</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rlines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">any</span><span class="p">(</span><span class="n">rlines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">sname</span><span class="p">)</span> <span class="k">for</span> <span class="n">sname</span> <span class="ow">in</span> <span class="n">section_names</span><span class="p">)):</span>
            <span class="n">nextl</span> <span class="o">=</span> <span class="n">rlines</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">nextl</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="c1"># depending on the column name, parse differently</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">:</span>
                <span class="c1"># e.g.</span>
                <span class="c1"># c -cc-na   86.700     123.270   same as c2-cc-na, penalty score=  2.6</span>
                <span class="n">atom_types</span> <span class="o">=</span> <span class="n">nextl</span><span class="p">[:</span><span class="mi">8</span><span class="p">]</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">nextl</span><span class="p">[</span><span class="mi">9</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># The harmonic force constants for the angle &quot;ITT&quot;-&quot;JTT&quot;-</span>
                <span class="c1">#                     &quot;KTT&quot; in units of kcal/mol/(rad**2) (radians are the</span>
                <span class="c1">#                     traditional unit for angle parameters in force fields).</span>
                <span class="n">harmonicForceConstant</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="c1"># TEQ        The equilibrium bond angle for the above angle in degrees.</span>
                <span class="n">eq_bond_angle</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="c1"># the overall angle</span>
                <span class="n">section</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">harmonicForceConstant</span><span class="p">,</span> <span class="n">eq_bond_angle</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DIHE&#39;</span><span class="p">:</span>
                <span class="c1"># e.g.</span>
                <span class="c1"># ca-ca-cd-cc   1    0.505       180.000           2.000      same as c2-ce-ca-ca, penalty score=229.0</span>
                <span class="n">atom_types</span> <span class="o">=</span> <span class="n">nextl</span><span class="p">[:</span><span class="mi">11</span><span class="p">]</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">nextl</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                IDIVF      The factor by which the torsional barrier is divided.</span>
<span class="sd">                    Consult Weiner, et al., JACS 106:765 (1984) p. 769 for</span>
<span class="sd">                    details. Basically, the actual torsional potential is</span>

<span class="sd">                           (PK/IDIVF) * (1 + cos(PN*phi - PHASE))</span>

<span class="sd">                 PK         The barrier height divided by a factor of 2.</span>

<span class="sd">                 PHASE      The phase shift angle in the torsional function.</span>

<span class="sd">                            The unit is degrees.</span>

<span class="sd">                 PN         The periodicity of the torsional barrier.</span>
<span class="sd">                            NOTE: If PN .lt. 0.0 then the torsional potential</span>
<span class="sd">                                  is assumed to have more than one term, and the</span>
<span class="sd">                                  values of the rest of the terms are read from the</span>
<span class="sd">                                  next cards until a positive PN is encountered.  The</span>
<span class="sd">                                  negative value of pn is used only for identifying</span>
<span class="sd">                                  the existence of the next term and only the</span>
<span class="sd">                                  absolute value of PN is kept.</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">IDIVF</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">PK</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">PHASE</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">PN</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">section</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">IDIVF</span><span class="p">,</span> <span class="n">PK</span><span class="p">,</span> <span class="n">PHASE</span><span class="p">,</span> <span class="n">PN</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;IMPROPER&#39;</span><span class="p">:</span>
                <span class="c1"># e.g.</span>
                <span class="c1"># cc-o -c -o          1.1          180.0         2.0          Using general improper torsional angle  X- o- c- o, penalty score=  3.0)</span>
                <span class="c1"># ...  IDIVF , PK , PHASE , PN</span>
                <span class="n">atom_types</span> <span class="o">=</span> <span class="n">nextl</span><span class="p">[:</span><span class="mi">11</span><span class="p">]</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">nextl</span><span class="p">[</span><span class="mi">11</span><span class="p">:]</span><span class="o">.</span><span class="n">split</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="c1"># fixme - what is going on here? why is not generated this number?</span>
                <span class="c1"># IDIVF = float(other.pop())</span>
                <span class="n">PK</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">PHASE</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="n">PN</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pop</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">PN</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unimplemented - ordering using with negative 0&#39;</span><span class="p">)</span>
                <span class="n">section</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">atom_types</span><span class="p">,</span> <span class="n">PK</span><span class="p">,</span> <span class="n">PHASE</span><span class="p">,</span> <span class="n">PN</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">section</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nextl</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">section</span><span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">load_frcmod</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
        <span class="c1"># remark line</span>
        <span class="n">rlines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">assert</span> <span class="s1">&#39;Remark&#39;</span> <span class="ow">in</span> <span class="n">rlines</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

        <span class="n">parsed</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">section_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MASS&#39;</span><span class="p">,</span> <span class="s1">&#39;BOND&#39;</span><span class="p">,</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">,</span> <span class="s1">&#39;DIHE&#39;</span><span class="p">,</span> <span class="s1">&#39;IMPROPER&#39;</span><span class="p">,</span> <span class="s1">&#39;NONBON&#39;</span><span class="p">]:</span>
            <span class="n">parsed</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">get_section</span><span class="p">(</span><span class="n">section_name</span><span class="p">,</span> <span class="n">rlines</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">parsed</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">join_frcmod</span><span class="p">(</span><span class="n">left_frc</span><span class="p">,</span> <span class="n">right_frc</span><span class="p">):</span>
        <span class="n">joined</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">left_frc</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">right_frc</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">lname</span><span class="p">,</span> <span class="n">litems</span> <span class="o">=</span> <span class="n">left</span>
            <span class="n">rname</span><span class="p">,</span> <span class="n">ritems</span> <span class="o">=</span> <span class="n">right</span>
            <span class="k">assert</span> <span class="n">lname</span> <span class="o">==</span> <span class="n">rname</span>

            <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">litems</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">lname</span> <span class="o">==</span> <span class="s1">&#39;MASS&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">litems</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">ritems</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unimplemented&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lname</span> <span class="o">==</span> <span class="s1">&#39;BOND&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ritem</span> <span class="ow">in</span> <span class="n">ritems</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">litems</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">ritems</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">ritem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unimplemented&#39;</span><span class="p">)</span>
            <span class="c1"># ANGLE, e.g.</span>
            <span class="c1"># c -cc-na   86.700     123.270   same as c2-cc-na, penalty score=  2.6</span>
            <span class="k">elif</span> <span class="n">lname</span> <span class="o">==</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ritem</span> <span class="ow">in</span> <span class="n">ritems</span><span class="p">:</span>
                    <span class="c1"># if the item is not in the litems, add it there</span>
                    <span class="c1"># extra the first three terms to determine if it is present</span>
                    <span class="c1"># fixme - note we are ignoring the &quot;same as&quot; note</span>
                    <span class="k">if</span> <span class="n">ritem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]:</span>
                        <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ritem</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lname</span> <span class="o">==</span> <span class="s1">&#39;DIHE&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ritem</span> <span class="ow">in</span> <span class="n">ritems</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ritem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]:</span>
                        <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ritem</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lname</span> <span class="o">==</span> <span class="s1">&#39;IMPROPER&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ritem</span> <span class="ow">in</span> <span class="n">ritems</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">ritem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]:</span>
                        <span class="n">joined</span><span class="p">[</span><span class="n">lname</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ritem</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">lname</span> <span class="o">==</span> <span class="s1">&#39;NONBON&#39;</span><span class="p">:</span>
                <span class="c1"># if they&#39;re empty</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">litems</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ritems</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unimplemented&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unimplemented&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">joined</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">write_frcmod</span><span class="p">(</span><span class="n">frcmod</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FOUT</span><span class="p">:</span>
            <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;GENERATED .frcmod by joining two .frcmod files&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">sname</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">frcmod</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sname</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                    <span class="n">atom_types</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">atom_types</span><span class="p">)</span>
                    <span class="n">numbers</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">:]])</span>
                    <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39; </span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">numbers</span><span class="p">)</span>
                    <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
                <span class="c1"># the ending line</span>
                <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>

    <span class="n">left_frc</span> <span class="o">=</span> <span class="n">load_frcmod</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span>
    <span class="n">right_frc</span> <span class="o">=</span> <span class="n">load_frcmod</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span>
    <span class="n">joined_frc</span> <span class="o">=</span> <span class="n">join_frcmod</span><span class="p">(</span><span class="n">left_frc</span><span class="p">,</span> <span class="n">right_frc</span><span class="p">)</span>
    <span class="n">write_frcmod</span><span class="p">(</span><span class="n">joined_frc</span><span class="p">,</span> <span class="n">output_filepath</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.correct_fep_tempfactor" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">correct_fep_tempfactor</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">correct_fep_tempfactor</span><span class="p">(</span><span class="n">fep_summary</span><span class="p">,</span> <span class="n">source_pdb_filename</span><span class="p">,</span> <span class="n">new_pdb_filename</span><span class="p">,</span> <span class="n">hybrid_topology</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>fixme - this function does not need to use the file?
we have the json information available here.</p>
<p>Sets the temperature column in the PDB file
So that the number reflects the alchemical information
Requires by NAMD in order to know which atoms
appear (1) and which disappear (-1).</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">correct_fep_tempfactor</span><span class="p">(</span><span class="n">fep_summary</span><span class="p">,</span> <span class="n">source_pdb_filename</span><span class="p">,</span> <span class="n">new_pdb_filename</span><span class="p">,</span> <span class="n">hybrid_topology</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    fixme - this function does not need to use the file?</span>
<span class="sd">    we have the json information available here.</span>

<span class="sd">    Sets the temperature column in the PDB file</span>
<span class="sd">    So that the number reflects the alchemical information</span>
<span class="sd">    Requires by NAMD in order to know which atoms</span>
<span class="sd">    appear (1) and which disappear (-1).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">hybrid_topology</span><span class="p">:</span>
        <span class="c1"># delegate correcting fep column in the pdb file</span>
        <span class="k">return</span> <span class="n">_correct_fep_tempfactor_single_top</span><span class="p">(</span><span class="n">fep_summary</span><span class="p">,</span> <span class="n">source_pdb_filename</span><span class="p">,</span> <span class="n">new_pdb_filename</span><span class="p">)</span>

    <span class="n">pmdpdb</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">source_pdb_filename</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;HYB&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">a</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">pmdpdb</span><span class="o">.</span><span class="n">atoms</span><span class="p">}:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Missing the resname &quot;HYB&quot; in the pdb file prepared for fep&#39;</span><span class="p">)</span>

    <span class="c1"># dual-topology info</span>
    <span class="n">matched</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fep_summary</span><span class="p">[</span><span class="s1">&#39;superimposition&#39;</span><span class="p">][</span><span class="s1">&#39;matched&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">appearing_atoms</span> <span class="o">=</span> <span class="n">fep_summary</span><span class="p">[</span><span class="s1">&#39;superimposition&#39;</span><span class="p">][</span><span class="s1">&#39;appearing&#39;</span><span class="p">]</span>
    <span class="n">disappearing_atoms</span> <span class="o">=</span> <span class="n">fep_summary</span><span class="p">[</span><span class="s1">&#39;superimposition&#39;</span><span class="p">][</span><span class="s1">&#39;disappearing&#39;</span><span class="p">]</span>

    <span class="c1"># update the Temp column</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">pmdpdb</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="c1"># ignore water and ions and non-ligand resname</span>
        <span class="c1"># we only modify the protein, so ignore the ligand resnames</span>
        <span class="c1"># fixme .. why is it called mer, is it tleap?</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;HYB&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="c1"># if the atom was &quot;matched&quot;, meaning present in both ligands (left and right)</span>
        <span class="c1"># then ignore</span>
        <span class="c1"># note: we only use the left ligand</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">matched</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">appearing_atoms</span><span class="p">:</span>
            <span class="c1"># appearing atoms should</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">bfactor</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">disappearing_atoms</span><span class="p">:</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">bfactor</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;This should never happen. It has to be one of the cases&#39;</span><span class="p">)</span>

    <span class="n">pmdpdb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">new_pdb_filename</span><span class="p">),</span> <span class="n">use_hetatoms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># , file_format=&#39;PDB&#39;) - fixme?</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.get_PBC_coords" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_PBC_coords</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_PBC_coords</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Return [x, y, z]</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_PBC_coords</span><span class="p">(</span><span class="n">pdb_file</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return [x, y, z]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;This should not be called PBC coords. Revisit&#39;</span><span class="p">)</span>
    <span class="c1"># u = load(pdb_file)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">positions</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.extract_PBC_oct_from_tleap_log" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">extract_PBC_oct_from_tleap_log</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">extract_PBC_oct_from_tleap_log</span><span class="p">(</span><span class="n">leap_log</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>http://ambermd.org/namd/namd_amber.html
Return the 9 numbers for the truncated octahedron unit cell in namd
cellBasisVector1  d         0.0            0.0
cellBasisVector2  (-1/3)<em>d (2/3)sqrt(2)</em>d  0.0
cellBasisVector3  (-1/3)<em>d (-1/3)sqrt(2)</em>d (-1/3)sqrt(6)*d</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">extract_PBC_oct_from_tleap_log</span><span class="p">(</span><span class="n">leap_log</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    http://ambermd.org/namd/namd_amber.html</span>
<span class="sd">    Return the 9 numbers for the truncated octahedron unit cell in namd</span>
<span class="sd">    cellBasisVector1  d         0.0            0.0</span>
<span class="sd">    cellBasisVector2  (-1/3)*d (2/3)sqrt(2)*d  0.0</span>
<span class="sd">    cellBasisVector3  (-1/3)*d (-1/3)sqrt(2)*d (-1/3)sqrt(6)*d</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leapl_log_lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">leap_log</span><span class="p">)</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="n">line_to_extract</span> <span class="o">=</span> <span class="s2">&quot;Total bounding box for atom centers:&quot;</span>
    <span class="n">line_of_interest</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">l</span><span class="p">:</span> <span class="n">line_to_extract</span> <span class="ow">in</span> <span class="n">l</span><span class="p">,</span> <span class="n">leapl_log_lines</span><span class="p">))</span>
    <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span> <span class="o">=</span> <span class="n">line_of_interest</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">line_to_extract</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
    <span class="n">d1</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">d3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">d1</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">d2</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">d3</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">d1</span> <span class="o">==</span> <span class="n">d2</span> <span class="o">==</span> <span class="n">d3</span>
    <span class="c1"># scale the d since after minimisation the system turns out to be much smaller?</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">*</span> <span class="mf">0.8</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;cbv1&#39;</span><span class="p">:</span> <span class="n">d</span><span class="p">,</span> <span class="s1">&#39;cbv2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;cbv3&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;cbv4&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;cbv5&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;cbv6&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;cbv7&#39;</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;cbv8&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mf">3.0</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">,</span> <span class="s1">&#39;cbv9&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">d</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.prepare_antechamber_parmchk2" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">prepare_antechamber_parmchk2</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prepare_antechamber_parmchk2</span><span class="p">(</span><span class="n">source_script</span><span class="p">,</span> <span class="n">target_script</span><span class="p">,</span> <span class="n">net_charge</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Prepare the ambertools scripts.
Particularly, create the scritp so that it has the net charge</p>
<h3 id="ties.generator.prepare_antechamber_parmchk2--fixme-run-antechamber-directly-with-the-right-settings-from-here">fixme - run antechamber directly with the right settings from here?</h3>
<h3 id="ties.generator.prepare_antechamber_parmchk2--fixme-check-if-antechamber-has-a-python-interface">fixme - check if antechamber has a python interface?</h3>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepare_antechamber_parmchk2</span><span class="p">(</span><span class="n">source_script</span><span class="p">,</span> <span class="n">target_script</span><span class="p">,</span> <span class="n">net_charge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Prepare the ambertools scripts.</span>
<span class="sd">    Particularly, create the scritp so that it has the net charge</span>
<span class="sd">    # fixme - run antechamber directly with the right settings from here?</span>
<span class="sd">    # fixme - check if antechamber has a python interface?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">net_charge_set</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">source_script</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">net_charge</span><span class="o">=</span><span class="n">net_charge</span><span class="p">)</span>
    <span class="nb">open</span><span class="p">(</span><span class="n">target_script</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">net_charge_set</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.get_protein_net_charge" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">get_protein_net_charge</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">get_protein_net_charge</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">protein_file</span><span class="p">,</span> <span class="n">ambertools_tleap</span><span class="p">,</span> <span class="n">leap_input_file</span><span class="p">,</span> <span class="n">prot_ff</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Use automatic ambertools solvation of a single component to determine what is the next charge of the system.
This should be replaced with pka/propka or something akin.
Note that this is unsuitable for the hybrid ligand: ambertools does not understand a hybrid ligand
and might assign the wront net charge.</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_protein_net_charge</span><span class="p">(</span><span class="n">working_dir</span><span class="p">,</span> <span class="n">protein_file</span><span class="p">,</span> <span class="n">ambertools_tleap</span><span class="p">,</span> <span class="n">leap_input_file</span><span class="p">,</span> <span class="n">prot_ff</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Use automatic ambertools solvation of a single component to determine what is the next charge of the system.</span>
<span class="sd">    This should be replaced with pka/propka or something akin.</span>
<span class="sd">    Note that this is unsuitable for the hybrid ligand: ambertools does not understand a hybrid ligand</span>
<span class="sd">    and might assign the wront net charge.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">cwd</span> <span class="o">=</span> <span class="n">working_dir</span> <span class="o">/</span> <span class="s1">&#39;prep&#39;</span> <span class="o">/</span> <span class="s1">&#39;prep_protein_to_find_net_charge&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cwd</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
        <span class="n">cwd</span><span class="o">.</span><span class="n">mkdir</span><span class="p">()</span>

    <span class="c1"># copy the protein</span>
    <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">working_dir</span> <span class="o">/</span> <span class="n">protein_file</span><span class="p">,</span> <span class="n">cwd</span><span class="p">)</span>

    <span class="c1"># use ambertools to solvate the protein: set ion numbers to 0 so that they are determined automatically</span>
    <span class="c1"># fixme - consider moving out of the complex</span>
    <span class="n">leap_in_conf</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">leap_input_file</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">ligand_ff</span> <span class="o">=</span> <span class="s1">&#39;leaprc.gaff&#39;</span> <span class="c1"># ignored but must be provided</span>
    <span class="nb">open</span><span class="p">(</span><span class="n">cwd</span> <span class="o">/</span> <span class="s1">&#39;solv_prot.in&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">leap_in_conf</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">protein_ff</span><span class="o">=</span><span class="n">prot_ff</span><span class="p">,</span> <span class="n">ligand_ff</span><span class="o">=</span><span class="n">ligand_ff</span><span class="p">,</span>
                                                                          <span class="n">protein_file</span><span class="o">=</span><span class="n">protein_file</span><span class="p">))</span>

    <span class="n">log_filename</span> <span class="o">=</span> <span class="n">cwd</span> <span class="o">/</span> <span class="s2">&quot;ties_tleap.log&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">LOG</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">ambertools_tleap</span><span class="p">,</span> <span class="s1">&#39;-s&#39;</span><span class="p">,</span> <span class="s1">&#39;-f&#39;</span><span class="p">,</span> <span class="s1">&#39;solv_prot.in&#39;</span><span class="p">],</span>
                           <span class="n">cwd</span> <span class="o">=</span> <span class="n">cwd</span><span class="p">,</span>
                           <span class="n">stdout</span><span class="o">=</span><span class="n">LOG</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">LOG</span><span class="p">,</span>
                           <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">timeout</span><span class="o">=</span><span class="mi">60</span> <span class="o">*</span> <span class="mi">2</span>  <span class="c1"># 2 minutes</span>
                        <span class="p">)</span>
        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">E</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: tleap could generate a simple topology for the protein to check the number of ions. &#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ERROR: The output was saved in the directory: </span><span class="si">{</span><span class="n">cwd</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;ERROR: can be found in the file: </span><span class="si">{</span><span class="n">log_filename</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">E</span>


    <span class="c1"># read the file to see how many ions were added</span>
    <span class="n">newsys</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cwd</span> <span class="o">/</span> <span class="s1">&#39;prot_solv.pdb&#39;</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">newsys</span><span class="o">.</span><span class="n">atoms</span><span class="p">]</span>
    <span class="n">cl</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Cl-&#39;</span><span class="p">)</span>
    <span class="n">na</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s1">&#39;Na+&#39;</span><span class="p">)</span>  

    <span class="k">if</span> <span class="n">cl</span> <span class="o">&gt;</span> <span class="n">na</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">cl</span><span class="o">-</span><span class="n">na</span>
    <span class="k">elif</span> <span class="n">cl</span> <span class="o">&lt;</span> <span class="n">na</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="p">(</span><span class="n">na</span><span class="o">-</span><span class="n">cl</span><span class="p">)</span>

    <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.prepareFile" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">prepareFile</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">prepareFile</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">symbolic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Either copies or sets up a relative link between the files.
This allows for a quick switch in how the directory structure is organised.
Using relative links means that the entire TIES ligand or TIES complex
has to be moved together.
However, one might want to be able to send a single replica anywhere and
execute it independantly (suitable for BOINC).</p>
<p>@type: 'sym' or 'copy'</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prepareFile</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">symbolic</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Either copies or sets up a relative link between the files.</span>
<span class="sd">    This allows for a quick switch in how the directory structure is organised.</span>
<span class="sd">    Using relative links means that the entire TIES ligand or TIES complex</span>
<span class="sd">    has to be moved together.</span>
<span class="sd">    However, one might want to be able to send a single replica anywhere and</span>
<span class="sd">    execute it independantly (suitable for BOINC).</span>

<span class="sd">    @type: &#39;sym&#39; or &#39;copy&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">symbolic</span><span class="p">:</span>
        <span class="c1"># note that deleting all the files is intrusive, todo</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">symlink</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">dst</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">dst</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.set_coor_from_ref_by_named_pairs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">set_coor_from_ref_by_named_pairs</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_coor_from_ref_by_named_pairs</span><span class="p">(</span><span class="n">mol2_filename</span><span class="p">,</span> <span class="n">coor_ref_filename</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">,</span> <span class="n">left_right_pairs_filename</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Set coordinates but use atom names provided by the user.</p>
<p>Example of the left_right_pairs_filename content:</p>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--flip-the-first-ring">flip the first ring</h3>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--move-the-first-c-and-its-h">move the first c and its h</h3>
<p>C32 C18
H34 C19</p>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--second-pair">second pair</h3>
<p>C33 C17</p>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--the-actual-matching-pair">the actual matching pair</h3>
<p>C31 C16
H28 H11</p>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--the-second-matching-pair">the second matching pair</h3>
<p>C30 C15
H29 H12</p>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--_1"></h3>
<p>C35 C14</p>
<h3 id="ties.generator.set_coor_from_ref_by_named_pairs--flip-the-other-ring-with-itself">flip the other ring with itself</h3>
<p>C39 C36
C36 C39
H33 H30
H30 H33
C37 C38
C38 C37
H31 H32
H32 H31</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_coor_from_ref_by_named_pairs</span><span class="p">(</span><span class="n">mol2_filename</span><span class="p">,</span> <span class="n">coor_ref_filename</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">,</span> <span class="n">left_right_pairs_filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set coordinates but use atom names provided by the user.</span>

<span class="sd">    Example of the left_right_pairs_filename content:</span>
<span class="sd">    # flip the first ring</span>
<span class="sd">    # move the first c and its h</span>
<span class="sd">    C32 C18</span>
<span class="sd">    H34 C19</span>
<span class="sd">    # second pair</span>
<span class="sd">    C33 C17</span>
<span class="sd">    # the actual matching pair</span>
<span class="sd">    C31 C16</span>
<span class="sd">    H28 H11</span>
<span class="sd">    # the second matching pair</span>
<span class="sd">    C30 C15</span>
<span class="sd">    H29 H12</span>
<span class="sd">    #</span>
<span class="sd">    C35 C14</span>
<span class="sd">    # flip the other ring with itself</span>
<span class="sd">    C39 C36</span>
<span class="sd">    C36 C39</span>
<span class="sd">    H33 H30</span>
<span class="sd">    H30 H33</span>
<span class="sd">    C37 C38</span>
<span class="sd">    C38 C37</span>
<span class="sd">    H31 H32</span>
<span class="sd">    H32 H31</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># fixme - check if the names are unique</span>

    <span class="c1"># parse &quot;left_right_pairs_filename</span>
    <span class="c1"># format per line: leftatom_name right_atom_name</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">left_right_pairs_filename</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span>
    <span class="n">left_right_pairs</span> <span class="o">=</span> <span class="p">(</span><span class="n">l</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lines</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">l</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">))</span>

    <span class="c1"># load the ref coordinates</span>
    <span class="n">ref_mol2</span> <span class="o">=</span> <span class="n">load_mol2_wrapper</span><span class="p">(</span><span class="n">coor_ref_filename</span><span class="p">)</span>
    <span class="c1"># load the .mol2 files with ParmEd and correct the charges</span>
    <span class="n">static_mol2</span> <span class="o">=</span> <span class="n">load_mol2_wrapper</span><span class="p">(</span><span class="n">mol2_filename</span><span class="p">)</span>
    <span class="c1"># this is being modified</span>
    <span class="n">mod_mol2</span> <span class="o">=</span> <span class="n">load_mol2_wrapper</span><span class="p">(</span><span class="n">mol2_filename</span><span class="p">)</span>


    <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">left_right_pairs</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;find pair&#39;</span><span class="p">,</span> <span class="n">pair</span><span class="p">)</span>
        <span class="n">new_pos</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">mol2_atom</span> <span class="ow">in</span> <span class="n">static_mol2</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="c1"># check if we are assigning from another molecule</span>
            <span class="k">for</span> <span class="n">ref_atom</span> <span class="ow">in</span> <span class="n">ref_mol2</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mol2_atom</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">ref_atom</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">new_pos</span> <span class="o">=</span> <span class="n">ref_atom</span><span class="o">.</span><span class="n">position</span>
            <span class="c1"># check if we are trying to assing coords from the same molecule</span>
            <span class="k">for</span> <span class="n">another_atom</span> <span class="ow">in</span> <span class="n">static_mol2</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">mol2_atom</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">another_atom</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">new_pos</span> <span class="o">=</span> <span class="n">another_atom</span><span class="o">.</span><span class="n">position</span>

        <span class="k">if</span> <span class="n">new_pos</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Could not find this pair: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pair</span><span class="p">))</span>

        <span class="c1"># assign the position to the right atom</span>
        <span class="c1"># find pair[0]</span>
        <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">mod_mol2</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">atom</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">new_pos</span>
                <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">assert</span> <span class="n">found</span>


    <span class="c1"># update the mol2 file</span>
    <span class="n">mod_mol2</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output_filename</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.update_PBC_in_namd_input" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">update_PBC_in_namd_input</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">update_PBC_in_namd_input</span><span class="p">(</span><span class="n">namd_filename</span><span class="p">,</span> <span class="n">new_pbc_box</span><span class="p">,</span> <span class="n">structure_filename</span><span class="p">,</span> <span class="n">constraint_lines</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>fixme - rename this file since it generates the .eq files
These are the lines we modify:
cellBasisVector1    {cell_x}  0.000  0.000
cellBasisVector2     0.000  {cell_y}  0.000
cellBasisVector3     0.000  0.000 {cell_z}</p>
<p>With x/y/z replacing the 3 values</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_PBC_in_namd_input</span><span class="p">(</span><span class="n">namd_filename</span><span class="p">,</span> <span class="n">new_pbc_box</span><span class="p">,</span> <span class="n">structure_filename</span><span class="p">,</span> <span class="n">constraint_lines</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    fixme - rename this file since it generates the .eq files</span>
<span class="sd">    These are the lines we modify:</span>
<span class="sd">    cellBasisVector1	{cell_x}  0.000  0.000</span>
<span class="sd">    cellBasisVector2	 0.000  {cell_y}  0.000</span>
<span class="sd">    cellBasisVector3	 0.000  0.000 {cell_z}</span>

<span class="sd">    With x/y/z replacing the 3 values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_pbc_box</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>

    <span class="n">reformatted_namd_in</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">namd_filename</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">cell_x</span><span class="o">=</span><span class="n">new_pbc_box</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cell_y</span><span class="o">=</span><span class="n">new_pbc_box</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cell_z</span><span class="o">=</span><span class="n">new_pbc_box</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>

        <span class="n">constraints</span><span class="o">=</span><span class="n">constraint_lines</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;test_output&#39;</span><span class="p">,</span> <span class="n">structure</span><span class="o">=</span><span class="n">structure_filename</span><span class="p">)</span>

    <span class="c1"># write to the file</span>
    <span class="nb">open</span><span class="p">(</span><span class="n">namd_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reformatted_namd_in</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.create_constraint_files" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_constraint_files</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_constraint_files</span><span class="p">(</span><span class="n">original_pdb</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>:param original_pdb:
:param output:
:return:</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_constraint_files</span><span class="p">(</span><span class="n">original_pdb</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    :param original_pdb:</span>
<span class="sd">    :param output:</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">sys</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">original_pdb</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># for each atom, give the B column the right value</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="c1"># ignore water</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">residue</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WAT&#39;</span><span class="p">,</span> <span class="s1">&#39;Na+&#39;</span><span class="p">,</span> <span class="s1">&#39;TIP3W&#39;</span><span class="p">,</span> <span class="s1">&#39;TIP3&#39;</span><span class="p">,</span> <span class="s1">&#39;HOH&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC&#39;</span><span class="p">,</span> <span class="s1">&#39;TIP4P&#39;</span><span class="p">]:</span>
            <span class="k">continue</span>

        <span class="c1"># set each atom depending on whether it is a H or not</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">):</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">bfactor</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># restrain the heavy atom</span>
            <span class="n">atom</span><span class="o">.</span><span class="n">bfactor</span> <span class="o">=</span> <span class="mi">4</span>

    <span class="n">sys</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">use_hetatoms</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.init_namd_file_min" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">init_namd_file_min</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">init_namd_file_min</span><span class="p">(</span><span class="n">from_dir</span><span class="p">,</span> <span class="n">to_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">structure_name</span><span class="p">,</span> <span class="n">pbc_box</span><span class="p">,</span> <span class="n">protein</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>:param from_dir:
:param to_dir:
:param filename:
:param structure_name:
:param pbc_box:
:param protein:
:return:</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">init_namd_file_min</span><span class="p">(</span><span class="n">from_dir</span><span class="p">,</span> <span class="n">to_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">structure_name</span><span class="p">,</span> <span class="n">pbc_box</span><span class="p">,</span> <span class="n">protein</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    :param from_dir:</span>
<span class="sd">    :param to_dir:</span>
<span class="sd">    :param filename:</span>
<span class="sd">    :param structure_name:</span>
<span class="sd">    :param pbc_box:</span>
<span class="sd">    :param protein:</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">protein</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cons</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">constraints  on</span>
<span class="s2">consexp  2</span>
<span class="s2"># use the same file for the position reference and the B column</span>
<span class="s2">consref  ../build/</span><span class="si">{</span><span class="n">structure_name</span><span class="si">}</span><span class="s2">.pdb ;#need all positions</span>
<span class="s2">conskfile  ../build/cons.pdb</span>
<span class="s2">conskcol  B</span>
<span class="s2">        &quot;&quot;&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cons</span> <span class="o">=</span> <span class="s1">&#39;constraints  off&#39;</span>

    <span class="n">min_namd_initialised</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">from_dir</span><span class="p">,</span> <span class="n">filename</span><span class="p">))</span><span class="o">.</span><span class="n">read</span><span class="p">()</span> \
        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">structure_name</span><span class="o">=</span><span class="n">structure_name</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">,</span> <span class="o">**</span><span class="n">pbc_box</span><span class="p">)</span>
    <span class="n">out_name</span> <span class="o">=</span> <span class="s1">&#39;eq0.conf&#39;</span>
    <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">to_dir</span><span class="p">,</span> <span class="n">out_name</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">min_namd_initialised</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.generate_namd_prod" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">generate_namd_prod</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate_namd_prod</span><span class="p">(</span><span class="n">namd_prod</span><span class="p">,</span> <span class="n">dst_dir</span><span class="p">,</span> <span class="n">structure_name</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>:param namd_prod:
:param dst_dir:
:param structure_name:
:return:</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_namd_prod</span><span class="p">(</span><span class="n">namd_prod</span><span class="p">,</span> <span class="n">dst_dir</span><span class="p">,</span> <span class="n">structure_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    :param namd_prod:</span>
<span class="sd">    :param dst_dir:</span>
<span class="sd">    :param structure_name:</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">namd_prod</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">reformatted_namd_in</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;sim1&#39;</span><span class="p">,</span> <span class="n">structure_name</span><span class="o">=</span><span class="n">structure_name</span><span class="p">)</span>
    <span class="nb">open</span><span class="p">(</span><span class="n">dst_dir</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reformatted_namd_in</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.generate_namd_eq" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">generate_namd_eq</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate_namd_eq</span><span class="p">(</span><span class="n">namd_eq</span><span class="p">,</span> <span class="n">dst_dir</span><span class="p">,</span> <span class="n">structure_name</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">protein</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>:param namd_eq:
:param dst_dir:
:param structure_name:
:param engine:
:param protein:
:return:</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_namd_eq</span><span class="p">(</span><span class="n">namd_eq</span><span class="p">,</span> <span class="n">dst_dir</span><span class="p">,</span> <span class="n">structure_name</span><span class="p">,</span> <span class="n">engine</span><span class="p">,</span> <span class="n">protein</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>

<span class="sd">    :param namd_eq:</span>
<span class="sd">    :param dst_dir:</span>
<span class="sd">    :param structure_name:</span>
<span class="sd">    :param engine:</span>
<span class="sd">    :param protein:</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">input_data</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">namd_eq</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">run</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">constraintScaling 1</span>
<span class="s2">run 10000</span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="n">pressure</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">run</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># protocol - minimization</span>
<span class="s2">set factor 1</span>
<span class="s2">set nall 10</span>
<span class="s2">set n 1</span>

<span class="s2">while {$n &lt;= $nall} {</span>
<span class="s2">   constraintScaling $factor</span>
<span class="s2">   run 40000</span>
<span class="s2">   set n [expr $n + 1]</span>
<span class="s2">   set factor [expr $factor * 0.5]</span>
<span class="s2">}</span>

<span class="s2">constraintScaling 0</span>
<span class="s2">run 600000</span>
<span class="s2">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">engine</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;namd&#39;</span> <span class="ow">or</span> <span class="n">engine</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;namd2&#39;</span><span class="p">:</span>
                <span class="n">pressure</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">useGroupPressure      yes ;# needed for 2fs steps</span>
<span class="s2">useFlexibleCell       no  ;# no for water box, yes for membrane</span>
<span class="s2">useConstantArea       no  ;# no for water box, yes for membrane</span>
<span class="s2">BerendsenPressure                       on</span>
<span class="s2">BerendsenPressureTarget                 1.0</span>
<span class="s2">BerendsenPressureCompressibility        4.57e-5</span>
<span class="s2">BerendsenPressureRelaxationTime         100</span>
<span class="s2">BerendsenPressureFreq                   2</span>
<span class="s2">                &quot;&quot;&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pressure</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">useGroupPressure      yes ;# needed for 2fs steps</span>
<span class="s2">useFlexibleCell       no  ;# no for water box, yes for membrane</span>
<span class="s2">useConstantArea       no  ;# no for water box, yes for membrane</span>
<span class="s2">langevinPiston          on             # Nose-Hoover Langevin piston pressure control</span>
<span class="s2">langevinPistonTarget  1.01325          # target pressure in bar 1atm = 1.01325bar</span>
<span class="s2">langevinPistonPeriod  50.0             # oscillation period in fs. correspond to pgamma T=50fs=0.05ps</span>
<span class="s2">langevinPistonTemp    300              # f=1/T=20.0(pgamma)</span>
<span class="s2">langevinPistonDecay   25.0             # oscillation decay time. smaller value correspons to larger random</span>
<span class="s2">                                       # forces and increased coupling to the Langevin temp bath.</span>
<span class="s2">                                       # Equall or smaller than piston period</span>
<span class="s2">                &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">protein</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cons</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">        constraints  on</span>
<span class="s2">        consexp  2</span>
<span class="s2">        # use the same file for the position reference and the B column</span>
<span class="s2">        consref  ../build/</span><span class="si">{</span><span class="n">structure_name</span><span class="si">}</span><span class="s2">.pdb ;#need all positions</span>
<span class="s2">        conskfile  ../build/cons.pdb</span>
<span class="s2">        conskcol  B</span>
<span class="s2">                &quot;&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cons</span> <span class="o">=</span> <span class="s1">&#39;constraints  off&#39;</span>

        <span class="n">prev_output</span> <span class="o">=</span> <span class="s1">&#39;eq</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">reformatted_namd_in</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">constraints</span><span class="o">=</span><span class="n">cons</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;eq</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">),</span>
            <span class="n">prev_output</span><span class="o">=</span><span class="n">prev_output</span><span class="p">,</span> <span class="n">structure_name</span><span class="o">=</span><span class="n">structure_name</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="n">pressure</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">run</span><span class="p">)</span>

        <span class="n">next_eq_step_filename</span> <span class="o">=</span> <span class="n">dst_dir</span> <span class="o">/</span> <span class="p">(</span><span class="s2">&quot;eq</span><span class="si">%d</span><span class="s2">.conf&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="nb">open</span><span class="p">(</span><span class="n">next_eq_step_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">reformatted_namd_in</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="ties.generator.redistribute_charges" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">redistribute_charges</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">redistribute_charges</span><span class="p">(</span><span class="n">mda</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the original charges in the matched component.</p>

            <details class="quote">
              <summary>Source code in <code>ties/generator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">redistribute_charges</span><span class="p">(</span><span class="n">mda</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the original charges in the matched component.</span>
<span class="sd">    &quot;&quot;&quot;</span>


    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../config/" class="md-footer__link md-footer__link--prev" aria-label="Previous: &lt;code class=&#34;doc-symbol doc-symbol-nav doc-symbol-module&#34;&gt;&lt;/code&gt; config">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> config
              </div>
            </div>
          </a>
        
        
          
          <a href="../helpers/" class="md-footer__link md-footer__link--next" aria-label="Next: &lt;code class=&#34;doc-symbol doc-symbol-nav doc-symbol-module&#34;&gt;&lt;/code&gt; helpers">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> helpers
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Mateusz Bieniek
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.5090c770.min.js"></script>
      
    
  </body>
</html>