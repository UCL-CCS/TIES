
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Software for Relative Binding Free Energy calculations">
      
      
      
        <link rel="canonical" href="https://github.com/UCL-CCS/TIES/latest/reference/pair/">
      
      
        <link rel="prev" href="../namd_generator/">
      
      
        <link rel="next" href="../protein/">
      
      
      <link rel="icon" href="../../images/favicon-32x32.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>pair - TIES</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="light-blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ties.pair" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="TIES" class="md-header__button md-logo" aria-label="TIES" data-md-component="logo">
      
  <img src="../../images/android-chrome-192x192.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TIES
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> pair
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/UCL-CCS/TIES" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    UCL-CCS/TIES
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  
    
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        
  
  
    
  
  Installation

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../publications/" class="md-tabs__link">
        
  
  
    
  
  Publications

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../usage/cli/" class="md-tabs__link">
          
  
  
    
  
  Usage

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../api/ligand/" class="md-tabs__link">
          
  
  
    
  
  API reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../theory/" class="md-tabs__link">
          
  
  
    
  
  Theory

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="TIES" class="md-nav__button md-logo" aria-label="TIES" data-md-component="logo">
      
  <img src="../../images/android-chrome-192x192.png" alt="logo">

    </a>
    TIES
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UCL-CCS/TIES" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    UCL-CCS/TIES
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../.." class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../publications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Publications
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Usage
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CLI
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/ligand/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ligand
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/pair/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pair
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../api/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" checked>
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    All
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            All
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4_1" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ties
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_4_1" id="__nav_5_4_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_5_4_1">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ties
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> helpers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ligand/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ligand
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ligandmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> ligandmap
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../md/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> md
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../namd_generator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> namd_generator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> pair
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> pair
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ties.pair.Pair" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Pair
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Pair">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.superimpose" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;superimpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.set_suptop" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_suptop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.make_atom_names_unique" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;make_atom_names_unique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.check_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_json_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.merge_frcmod_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;merge_frcmod_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.overlap_fractions" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;overlap_fractions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../protein/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> protein
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../topology_superimposer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> topology_superimposer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4_1_14" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5_4_1_14" id="__nav_5_4_1_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_4_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4_1_14">
            <span class="md-nav__icon md-icon"></span>
            <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/mol2sdf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> mol2sdf
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/sdf2mol2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> sdf2mol2
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../theory/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../superimposition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Superimposition
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#ties.pair.Pair" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;Pair
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" Pair">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.superimpose" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;superimpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.set_suptop" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;set_suptop
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.make_atom_names_unique" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;make_atom_names_unique
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.check_json_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;check_json_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.merge_frcmod_files" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;merge_frcmod_files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ties.pair.Pair.overlap_fractions" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;overlap_fractions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<div class="doc doc-object doc-module">



<h1 id="ties.pair" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">pair</span>


</h1>

    <div class="doc doc-contents first">








<p><span class="doc-section-title">Classes:</span></p>
    <ul>
        <li class="doc-section-item field-body">
          <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-class&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-class-name&quot;&gt;Pair&lt;/span&gt; (&lt;code&gt;ties.pair.Pair&lt;/code&gt;)" href="#ties.pair.Pair">Pair</a></code></b>
          –
          <div class="doc-md-description">
            <p>Facilitates the creation of morphs.</p>
          </div>
        </li>
    </ul>







  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="ties.pair.Pair" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <span class="doc doc-object-name doc-class-name">Pair</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">Pair</span><span class="p">(</span><span class="n">ligA</span><span class="p">,</span> <span class="n">ligZ</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">


        <p>Facilitates the creation of morphs.
It offers functionality related to a pair of ligands (a transformation).</p>
<p>:param ligA: The ligand to be used as the starting state for the transformation.
:type ligA: :class:<code>Ligand</code> or string
:param ligZ: The ligand to be used as the ending point of the transformation.
:type ligZ: :class:<code>Ligand</code> or string
:param config: The configuration object holding all settings.
:type config: :class:<code>Config</code></p>

        <p>fixme - list all relevant kwargs here</p>
<pre><code>param ligand_net_charge: integer, net charge of each ligand (has to be the same)
</code></pre>










<p><span class="doc-section-title">Methods:</span></p>
    <ul>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;superimpose&lt;/span&gt; (&lt;code&gt;ties.pair.Pair.superimpose&lt;/code&gt;)" href="#ties.pair.Pair.superimpose">superimpose</a></code></b>
            –
            <div class="doc-md-description">
              <p>Please see :class:<code>Config</code> class for the documentation of kwargs. The passed kwargs overwrite the config</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;set_suptop&lt;/span&gt; (&lt;code&gt;ties.pair.Pair.set_suptop&lt;/code&gt;)" href="#ties.pair.Pair.set_suptop">set_suptop</a></code></b>
            –
            <div class="doc-md-description">
              <p>Attach a SuperimposedTopology object along with the ParmEd objects for the ligA and ligZ.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;make_atom_names_unique&lt;/span&gt; (&lt;code&gt;ties.pair.Pair.make_atom_names_unique&lt;/code&gt;)" href="#ties.pair.Pair.make_atom_names_unique">make_atom_names_unique</a></code></b>
            –
            <div class="doc-md-description">
              <p>Ensure that each that atoms across the two ligands have unique names.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;check_json_file&lt;/span&gt; (&lt;code&gt;ties.pair.Pair.check_json_file&lt;/code&gt;)" href="#ties.pair.Pair.check_json_file">check_json_file</a></code></b>
            –
            <div class="doc-md-description">
              <p>Performance optimisation in case TIES is rerun again. Return the first matched atoms which</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;merge_frcmod_files&lt;/span&gt; (&lt;code&gt;ties.pair.Pair.merge_frcmod_files&lt;/code&gt;)" href="#ties.pair.Pair.merge_frcmod_files">merge_frcmod_files</a></code></b>
            –
            <div class="doc-md-description">
              <p>Merges the .frcmod files generated for each ligand separately, simply by adding them together.</p>
            </div>
          </li>
          <li class="doc-section-item field-body">
            <b><code><a class="autorefs autorefs-internal" title="&lt;code class=&quot;doc-symbol doc-symbol-heading doc-symbol-method&quot;&gt;&lt;/code&gt;            &lt;span class=&quot;doc doc-object-name doc-function-name&quot;&gt;overlap_fractions&lt;/span&gt; (&lt;code&gt;ties.pair.Pair.overlap_fractions&lt;/code&gt;)" href="#ties.pair.Pair.overlap_fractions">overlap_fractions</a></code></b>
            –
            <div class="doc-md-description">
              <p>Calculate the size of the common area.</p>
            </div>
          </li>
    </ul>



                  <details class="quote">
                    <summary>Source code in <code>ties/pair.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ligA</span><span class="p">,</span> <span class="n">ligZ</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Please use the Config class for the documentation of the possible kwargs.</span>
<span class="sd">    Each kwarg is passed to the config class.</span>

<span class="sd">    fixme - list all relevant kwargs here</span>

<span class="sd">        param ligand_net_charge: integer, net charge of each ligand (has to be the same)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># create a new config if it is not provided</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">Config</span><span class="p">()</span> <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">config</span>

    <span class="c1"># channel all config variables to the config class</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># tell Config about the ligands if necessary</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ligands</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ligands</span> <span class="o">=</span> <span class="p">[</span><span class="n">ligA</span><span class="p">,</span> <span class="n">ligZ</span><span class="p">]</span>

    <span class="c1"># create ligands if they&#39;re just paths</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ligA</span><span class="p">,</span> <span class="n">ties</span><span class="o">.</span><span class="n">ligand</span><span class="o">.</span><span class="n">Ligand</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ligA</span> <span class="o">=</span> <span class="n">ligA</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ligA</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">ligand</span><span class="o">.</span><span class="n">Ligand</span><span class="p">(</span><span class="n">ligA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ligZ</span><span class="p">,</span> <span class="n">ties</span><span class="o">.</span><span class="n">ligand</span><span class="o">.</span><span class="n">Ligand</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span> <span class="o">=</span> <span class="n">ligZ</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">ligand</span><span class="o">.</span><span class="n">Ligand</span><span class="p">(</span><span class="n">ligZ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

    <span class="c1"># initialise the handles to the molecules that morph</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_ligA</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">current</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">current_ligZ</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">current</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">internal_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mol2</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pdb</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">summary</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">suptop</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mda_l1</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mda_l2</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">distance</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="ties.pair.Pair.superimpose" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">superimpose</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">superimpose</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Please see :class:<code>Config</code> class for the documentation of kwargs. The passed kwargs overwrite the config
object passed in the constructor.</p>
<p>fixme - list all relevant kwargs here</p>
<p>:param use_element_in_superimposition: bool whether the superimposition should rely on the element initially,
    before refining the results with a more specific check of the atom type.
:param manually_matched_atom_pairs:
:param manually_mismatched_pairs:
:param redistribute_q_over_unmatched:</p>


            <details class="quote">
              <summary>Source code in <code>ties/pair.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">superimpose</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Please see :class:`Config` class for the documentation of kwargs. The passed kwargs overwrite the config</span>
<span class="sd">    object passed in the constructor.</span>

<span class="sd">    fixme - list all relevant kwargs here</span>

<span class="sd">    :param use_element_in_superimposition: bool whether the superimposition should rely on the element initially,</span>
<span class="sd">        before refining the results with a more specific check of the atom type.</span>
<span class="sd">    :param manually_matched_atom_pairs:</span>
<span class="sd">    :param manually_mismatched_pairs:</span>
<span class="sd">    :param redistribute_q_over_unmatched:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">set_configs</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># use ParmEd to load the files</span>
    <span class="c1"># fixme - move this to the Morph class instead of this place,</span>
    <span class="c1"># fixme - should not squash all messsages. For example, wrong type file should not be squashed</span>
    <span class="n">leftlig_atoms</span><span class="p">,</span> <span class="n">leftlig_bonds</span><span class="p">,</span> <span class="n">rightlig_atoms</span><span class="p">,</span> <span class="n">rightlig_bonds</span><span class="p">,</span> <span class="n">parmed_ligA</span><span class="p">,</span> <span class="n">parmed_ligZ</span> <span class="o">=</span> \
        <span class="n">get_atoms_bonds_from_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ligA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">current_ligZ</span><span class="p">,</span>
                                  <span class="n">use_general_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_element_in_superimposition</span><span class="p">)</span>
    <span class="c1"># fixme - manual match should be improved here and allow for a sensible format.</span>

    <span class="c1"># in case the atoms were renamed, pass the names via the map renaming map</span>
    <span class="c1"># TODO</span>
    <span class="c1"># ligZ_old_new_atomname_map</span>
    <span class="n">new_mismatch_names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">z</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">manually_mismatched_pairs</span><span class="p">:</span>
        <span class="n">new_names</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">rev_renaming_map</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">rev_renaming_map</span><span class="p">[</span><span class="n">z</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Selecting mismatching atoms. The mismatch </span><span class="si">{</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">z</span><span class="p">)</span><span class="si">}</span><span class="s1">) was renamed to </span><span class="si">{</span><span class="n">new_names</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">new_mismatch_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_names</span><span class="p">)</span>

    <span class="c1"># assign</span>
    <span class="c1"># fixme - Ideally I would reuse the ParmEd data for this,</span>
    <span class="c1"># ParmEd can use bonds if they are present - fixme</span>
    <span class="c1"># map atom IDs to their objects</span>
    <span class="n">ligand1_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">atomNode</span> <span class="ow">in</span> <span class="n">leftlig_atoms</span><span class="p">:</span>
        <span class="n">ligand1_nodes</span><span class="p">[</span><span class="n">atomNode</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">atomNode</span>
    <span class="c1"># link them together</span>
    <span class="k">for</span> <span class="n">nfrom</span><span class="p">,</span> <span class="n">nto</span><span class="p">,</span> <span class="n">btype</span> <span class="ow">in</span> <span class="n">leftlig_bonds</span><span class="p">:</span>
        <span class="n">ligand1_nodes</span><span class="p">[</span><span class="n">nfrom</span><span class="p">]</span><span class="o">.</span><span class="n">bind_to</span><span class="p">(</span><span class="n">ligand1_nodes</span><span class="p">[</span><span class="n">nto</span><span class="p">],</span> <span class="n">btype</span><span class="p">)</span>

    <span class="n">ligand2_nodes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">atomNode</span> <span class="ow">in</span> <span class="n">rightlig_atoms</span><span class="p">:</span>
        <span class="n">ligand2_nodes</span><span class="p">[</span><span class="n">atomNode</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">atomNode</span>
    <span class="k">for</span> <span class="n">nfrom</span><span class="p">,</span> <span class="n">nto</span><span class="p">,</span> <span class="n">btype</span> <span class="ow">in</span> <span class="n">rightlig_bonds</span><span class="p">:</span>
        <span class="n">ligand2_nodes</span><span class="p">[</span><span class="n">nfrom</span><span class="p">]</span><span class="o">.</span><span class="n">bind_to</span><span class="p">(</span><span class="n">ligand2_nodes</span><span class="p">[</span><span class="n">nto</span><span class="p">],</span> <span class="n">btype</span><span class="p">)</span>

    <span class="c1"># fixme - this should be moved out of here,</span>
    <span class="c1">#  ideally there would be a function in the main interface for this</span>
    <span class="n">manual_match</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">manually_matched_atom_pairs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">manually_matched_atom_pairs</span>
    <span class="n">starting_node_pairs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">l_aname</span><span class="p">,</span> <span class="n">r_aname</span> <span class="ow">in</span> <span class="n">manual_match</span><span class="p">:</span>
        <span class="c1"># find the starting node pairs, ie the manually matched pair(s)</span>
        <span class="n">found_left_node</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">ligand1_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">l_aname</span> <span class="o">==</span> <span class="n">ln</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">found_left_node</span> <span class="o">=</span> <span class="n">ln</span>
        <span class="k">if</span> <span class="n">found_left_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Manual Matching: could not find an atom name: &quot;</span><span class="si">{</span><span class="n">l_aname</span><span class="si">}</span><span class="s1">&quot; in the left molecule&#39;</span><span class="p">)</span>

        <span class="n">found_right_node</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span> <span class="n">ln</span> <span class="ow">in</span> <span class="n">ligand2_nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">r_aname</span> <span class="o">==</span> <span class="n">ln</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="n">found_right_node</span> <span class="o">=</span> <span class="n">ln</span>
        <span class="k">if</span> <span class="n">found_right_node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Manual Matching: could not find an atom name: &quot;</span><span class="si">{</span><span class="n">r_aname</span><span class="si">}</span><span class="s1">&quot; in the right molecule&#39;</span><span class="p">)</span>

        <span class="n">starting_node_pairs</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">found_left_node</span><span class="p">,</span> <span class="n">found_right_node</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">starting_node_pairs</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting nodes will be used: </span><span class="si">{</span><span class="n">starting_node_pairs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">logging_key</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># fixme - simplify to only take the ParmEd as input</span>
    <span class="n">suptop</span> <span class="o">=</span> <span class="n">superimpose_topologies</span><span class="p">(</span><span class="n">ligand1_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">ligand2_nodes</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span>
                                    <span class="n">disjoint_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">allow_disjoint_components</span><span class="p">,</span>
                                    <span class="n">net_charge_filter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">pair_charge_atol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">atom_pair_q_atol</span><span class="p">,</span>
                                    <span class="n">net_charge_threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">net_charge_threshold</span><span class="p">,</span>
                                    <span class="n">redistribute_charges_over_unmatched</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">redistribute_q_over_unmatched</span><span class="p">,</span>
                                    <span class="n">ignore_charges_completely</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ignore_charges_completely</span><span class="p">,</span>
                                    <span class="n">ignore_bond_types</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                    <span class="n">ignore_coords</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">partial_rings_allowed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">partial_ring_allowed</span><span class="p">,</span>
                                    <span class="n">align_molecules</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">align_molecules_using_mcs</span><span class="p">,</span>
                                    <span class="n">use_general_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">use_element_in_superimposition</span><span class="p">,</span>
                                    <span class="c1"># fixme - not the same ... use_element_in_superimposition,</span>
                                    <span class="n">use_only_element</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                    <span class="n">check_atom_names_unique</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># fixme - remove?</span>
                                    <span class="n">starting_pairs_heuristics</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">superimposition_starting_heuristic</span><span class="p">,</span>  <span class="c1"># fixme - add to config</span>
                                    <span class="n">force_mismatch</span><span class="o">=</span><span class="n">new_mismatch_names</span><span class="p">,</span>
                                    <span class="n">starting_node_pairs</span><span class="o">=</span><span class="n">starting_node_pairs</span><span class="p">,</span>
                                    <span class="n">parmed_ligA</span><span class="o">=</span><span class="n">parmed_ligA</span><span class="p">,</span> <span class="n">parmed_ligZ</span><span class="o">=</span><span class="n">parmed_ligZ</span><span class="p">,</span>
                                    <span class="n">starting_pair_seed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">superimposition_starting_pairs</span><span class="p">,</span>
                                    <span class="n">logging_key</span><span class="o">=</span><span class="n">logging_key</span><span class="p">,</span>
                                    <span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">set_suptop</span><span class="p">(</span><span class="n">suptop</span><span class="p">,</span> <span class="n">parmed_ligA</span><span class="p">,</span> <span class="n">parmed_ligZ</span><span class="p">)</span>
    <span class="c1"># attach the used config to the suptop</span>

    <span class="k">if</span> <span class="n">suptop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">suptop</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span>
        <span class="c1"># attach the morph to the suptop</span>
        <span class="n">suptop</span><span class="o">.</span><span class="n">morph</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="k">return</span> <span class="n">suptop</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ties.pair.Pair.set_suptop" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">set_suptop</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">set_suptop</span><span class="p">(</span><span class="n">suptop</span><span class="p">,</span> <span class="n">parmed_ligA</span><span class="p">,</span> <span class="n">parmed_ligZ</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Attach a SuperimposedTopology object along with the ParmEd objects for the ligA and ligZ.</p>
<p>:param suptop: :class:<code>SuperimposedTopology</code>
:param parmed_ligA: An ParmEd for the ligA
:param parmed_ligZ: An ParmEd for the ligZ</p>


            <details class="quote">
              <summary>Source code in <code>ties/pair.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_suptop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">suptop</span><span class="p">,</span> <span class="n">parmed_ligA</span><span class="p">,</span> <span class="n">parmed_ligZ</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Attach a SuperimposedTopology object along with the ParmEd objects for the ligA and ligZ.</span>

<span class="sd">    :param suptop: :class:`SuperimposedTopology`</span>
<span class="sd">    :param parmed_ligA: An ParmEd for the ligA</span>
<span class="sd">    :param parmed_ligZ: An ParmEd for the ligZ</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">suptop</span> <span class="o">=</span> <span class="n">suptop</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parmed_ligA</span> <span class="o">=</span> <span class="n">parmed_ligA</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">parmed_ligZ</span> <span class="o">=</span> <span class="n">parmed_ligZ</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ties.pair.Pair.make_atom_names_unique" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">make_atom_names_unique</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">make_atom_names_unique</span><span class="p">(</span><span class="n">out_ligA_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_ligZ_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Ensure that each that atoms across the two ligands have unique names.</p>
<p>While renaming atoms, start with the element (C, N, ..) followed by
 the count so far (e.g. C1, C2, N1).</p>
<p>Resnames are set to "INI" and "FIN", this is useful for the hybrid dual topology.</p>
<p>:param out_ligA_filename: The new filenames for the ligands with renamed atoms. If None, the default
    naming convention is used.
:type out_ligA_filename: string or bool
:param out_ligZ_filename: The new filenames for the ligands with renamed atoms. If None, the default
    naming convention is used.
:type out_ligZ_filename: string or bool
:param save: Whether to save to the disk the ligands after renaming the atoms
:type save: bool</p>


            <details class="quote">
              <summary>Source code in <code>ties/pair.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_atom_names_unique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_ligA_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">out_ligZ_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Ensure that each that atoms across the two ligands have unique names.</span>

<span class="sd">    While renaming atoms, start with the element (C, N, ..) followed by</span>
<span class="sd">     the count so far (e.g. C1, C2, N1).</span>

<span class="sd">    Resnames are set to &quot;INI&quot; and &quot;FIN&quot;, this is useful for the hybrid dual topology.</span>

<span class="sd">    :param out_ligA_filename: The new filenames for the ligands with renamed atoms. If None, the default</span>
<span class="sd">        naming convention is used.</span>
<span class="sd">    :type out_ligA_filename: string or bool</span>
<span class="sd">    :param out_ligZ_filename: The new filenames for the ligands with renamed atoms. If None, the default</span>
<span class="sd">        naming convention is used.</span>
<span class="sd">    :type out_ligZ_filename: string or bool</span>
<span class="sd">    :param save: Whether to save to the disk the ligands after renaming the atoms</span>
<span class="sd">    :type save: bool</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># The A ligand is a template for the renaming</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">correct_atom_names</span><span class="p">()</span>

    <span class="c1"># load both ligands</span>
    <span class="n">left</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">current</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">right</span> <span class="o">=</span> <span class="n">parmed</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">current</span><span class="p">),</span> <span class="n">structure</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">common_atom_names</span> <span class="o">=</span> <span class="p">{</span><span class="n">a</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">atoms</span><span class="p">}</span><span class="o">.</span><span class="n">intersection</span><span class="p">({</span><span class="n">a</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">left</span><span class="o">.</span><span class="n">atoms</span><span class="p">})</span>
    <span class="n">atom_names_overlap</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_atom_names</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">atom_names_overlap</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">are_atom_names_correct</span><span class="p">():</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Renaming (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">) molecule (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">) atom names are either reused or do not follow the correct format. &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">atom_names_overlap</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Common atom names: </span><span class="si">{</span><span class="n">common_atom_names</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">name_counter_L_nodes</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">get_atom_names_counter</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">renaming_map</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">get_new_atom_names</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">name_counter</span><span class="o">=</span><span class="n">name_counter_L_nodes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">renaming_map</span> <span class="o">=</span> <span class="n">renaming_map</span>

    <span class="c1"># rename the residue names to INI and FIN</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">left</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">residue</span> <span class="o">=</span> <span class="s1">&#39;INI&#39;</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">right</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">residue</span> <span class="o">=</span> <span class="s1">&#39;FIN&#39;</span>

    <span class="c1"># fixme - instead of using the save parameter, have a method pair.save(filename1, filename2) and</span>
    <span class="c1">#  call it when necessary.</span>
    <span class="c1"># prepare the destination directory</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">out_ligA_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">pair_unique_atom_names_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">cwd</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">current_ligA</span> <span class="o">=</span> <span class="n">cwd</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span> <span class="o">+</span> <span class="s1">&#39;.mol2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_ligZ</span> <span class="o">=</span> <span class="n">cwd</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span> <span class="o">+</span> <span class="s1">&#39;.mol2&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_ligA</span> <span class="o">=</span> <span class="n">out_ligA_filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_ligZ</span> <span class="o">=</span> <span class="n">out_ligZ_filename</span>

    <span class="c1"># save the updated atom names</span>
    <span class="n">left</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ligA</span><span class="p">))</span>
    <span class="n">right</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">current_ligZ</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ties.pair.Pair.check_json_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">check_json_file</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">check_json_file</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Performance optimisation in case TIES is rerun again. Return the first matched atoms which
can be used as a seed for the superimposition.</p>
<p>:return: If the superimposition was computed before, and the .json file is available,
    gets one of the matched atoms.
:rtype: [(ligA_atom, ligZ_atom)]</p>


            <details class="quote">
              <summary>Source code in <code>ties/pair.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_json_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performance optimisation in case TIES is rerun again. Return the first matched atoms which</span>
<span class="sd">    can be used as a seed for the superimposition.</span>

<span class="sd">    :return: If the superimposition was computed before, and the .json file is available,</span>
<span class="sd">        gets one of the matched atoms.</span>
<span class="sd">    :rtype: [(ligA_atom, ligZ_atom)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matching_json</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">workdir</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;fep_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">.json&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">matching_json</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">matching_json</span><span class="o">.</span><span class="n">open</span><span class="p">())[</span><span class="s1">&#39;matched&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ties.pair.Pair.merge_frcmod_files" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">merge_frcmod_files</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">merge_frcmod_files</span><span class="p">(</span><span class="n">ligcom</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Merges the .frcmod files generated for each ligand separately, simply by adding them together.</p>
<p>The duplication has no effect on the final generated topology parm7 top file.</p>
<p>We are also testing the .frcmod here with the user's force field in order to check if
the merge works correctly.</p>
<p>:param ligcom: Either "lig" if only ligands are present, or "com" if the complex is present.
    Helps with the directory structure.
:type ligcom: string "lig" or "com"</p>


            <details class="quote">
              <summary>Source code in <code>ties/pair.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">merge_frcmod_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ligcom</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Merges the .frcmod files generated for each ligand separately, simply by adding them together.</span>

<span class="sd">    The duplication has no effect on the final generated topology parm7 top file.</span>

<span class="sd">    We are also testing the .frcmod here with the user&#39;s force field in order to check if</span>
<span class="sd">    the merge works correctly.</span>

<span class="sd">    :param ligcom: Either &quot;lig&quot; if only ligands are present, or &quot;com&quot; if the complex is present.</span>
<span class="sd">        Helps with the directory structure.</span>
<span class="sd">    :type ligcom: string &quot;lig&quot; or &quot;com&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ambertools_tleap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ambertools_tleap</span>
    <span class="n">ambertools_script_dir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ambertools_script_dir</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">protein</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">protein_ff</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">protein_ff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">protein_ff</span>

    <span class="n">ligand_ff</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">ligand_ff</span>

    <span class="n">frcmod_info1</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">parse_frcmod_sections</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">frcmod</span><span class="p">)</span>
    <span class="n">frcmod_info2</span> <span class="o">=</span> <span class="n">ties</span><span class="o">.</span><span class="n">helpers</span><span class="o">.</span><span class="n">parse_frcmod_sections</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">frcmod</span><span class="p">)</span>

    <span class="n">cwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">workdir</span>

    <span class="c1"># fixme: use the provided cwd here, otherwise this will not work if the wrong cwd is used</span>
    <span class="c1"># have some conf module instead of this</span>
    <span class="k">if</span> <span class="n">ligcom</span><span class="p">:</span>
        <span class="n">morph_frcmod</span> <span class="o">=</span> <span class="n">cwd</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;ties-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">/</span> <span class="n">ligcom</span> <span class="o">/</span> <span class="s1">&#39;build&#39;</span> <span class="o">/</span> <span class="s1">&#39;hybrid.frcmod&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># fixme - clean up</span>
        <span class="n">morph_frcmod</span> <span class="o">=</span> <span class="n">cwd</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;ties-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligA</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">ligZ</span><span class="o">.</span><span class="n">internal_name</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">/</span> <span class="s1">&#39;build&#39;</span> <span class="o">/</span> <span class="s1">&#39;hybrid.frcmod&#39;</span>
    <span class="n">morph_frcmod</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">morph_frcmod</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">FOUT</span><span class="p">:</span>
        <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;merged frcmod</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MASS&#39;</span><span class="p">,</span> <span class="s1">&#39;BOND&#39;</span><span class="p">,</span> <span class="s1">&#39;ANGLE&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;DIHE&#39;</span><span class="p">,</span> <span class="s1">&#39;IMPROPER&#39;</span><span class="p">,</span> <span class="s1">&#39;NONBON&#39;</span><span class="p">]:</span>
            <span class="n">section_lines</span> <span class="o">=</span> <span class="n">frcmod_info1</span><span class="p">[</span><span class="n">section</span><span class="p">]</span> <span class="o">+</span> <span class="n">frcmod_info2</span><span class="p">[</span><span class="n">section</span><span class="p">]</span>
            <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:s}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">section</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">section_lines</span><span class="p">:</span>
                <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:s}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">FOUT</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># this is our current frcmod file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">frcmod</span> <span class="o">=</span> <span class="n">morph_frcmod</span>

    <span class="c1"># as part of the .frcmod writing</span>
    <span class="c1"># insert dummy angles/dihedrals if a morph .frcmod requires</span>
    <span class="c1"># new terms between the appearing/disappearing atoms</span>
    <span class="c1"># this is a trick to make sure tleap has everything it needs to generate the .top file</span>
    <span class="n">correction_introduced</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_hybrid_frcmod</span><span class="p">(</span><span class="n">ambertools_tleap</span><span class="p">,</span> <span class="n">ambertools_script_dir</span><span class="p">,</span> <span class="n">protein_ff</span><span class="p">,</span> <span class="n">ligand_ff</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">correction_introduced</span><span class="p">:</span>
        <span class="c1"># move the .frcmod which turned out to be insufficient according to the test</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">morph_frcmod</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frcmod</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.uncorrected&#39;</span> <span class="p">)</span>
        <span class="c1"># now copy in place the corrected version</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frcmod</span><span class="p">,</span> <span class="n">morph_frcmod</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="ties.pair.Pair.overlap_fractions" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <span class="doc doc-object-name doc-function-name">overlap_fractions</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">overlap_fractions</span><span class="p">()</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Calculate the size of the common area.</p>
<p>:return: Four decimals capturing: 1) the fraction of the common size with respect to the ligA topology,
    2) the fraction of the common size with respect to the ligZ topology,
    3) the percentage of the disappearing atoms in the disappearing molecule
    4) the percentage of the appearing atoms  in the appearing molecule
:rtype: [float, float, float, float]</p>


            <details class="quote">
              <summary>Source code in <code>ties/pair.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">overlap_fractions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the size of the common area.</span>

<span class="sd">    :return: Four decimals capturing: 1) the fraction of the common size with respect to the ligA topology,</span>
<span class="sd">        2) the fraction of the common size with respect to the ligZ topology,</span>
<span class="sd">        3) the percentage of the disappearing atoms in the disappearing molecule</span>
<span class="sd">        4) the percentage of the appearing atoms  in the appearing molecule</span>
<span class="sd">    :rtype: [float, float, float, float]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suptop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mcs_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">matched_pairs</span><span class="p">)</span>

    <span class="n">matched_fraction_left</span> <span class="o">=</span> <span class="n">mcs_size</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">top1</span><span class="p">))</span>
    <span class="n">matched_fraction_right</span> <span class="o">=</span> <span class="n">mcs_size</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">top2</span><span class="p">))</span>
    <span class="n">disappearing_atoms_fraction</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">top1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mcs_size</span><span class="p">)</span> \
                               <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">top1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">appearing_atoms_fraction</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">top2</span><span class="p">)</span> <span class="o">-</span> <span class="n">mcs_size</span><span class="p">)</span> \
                               <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suptop</span><span class="o">.</span><span class="n">top2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="k">return</span> <span class="n">matched_fraction_left</span><span class="p">,</span> <span class="n">matched_fraction_right</span><span class="p">,</span> <span class="n">disappearing_atoms_fraction</span><span class="p">,</span> <span class="n">appearing_atoms_fraction</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../namd_generator/" class="md-footer__link md-footer__link--prev" aria-label="Previous: &lt;code class=&#34;doc-symbol doc-symbol-nav doc-symbol-module&#34;&gt;&lt;/code&gt; namd_generator">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> namd_generator
              </div>
            </div>
          </a>
        
        
          
          <a href="../protein/" class="md-footer__link md-footer__link--next" aria-label="Next: &lt;code class=&#34;doc-symbol doc-symbol-nav doc-symbol-module&#34;&gt;&lt;/code&gt; protein">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                <code class="doc-symbol doc-symbol-nav doc-symbol-module"></code> protein
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Mateusz Bieniek
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "search.highlight", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>