# solvation script to solvate the merged topologies .mol2
source {protein_ff}
source leaprc.water.tip3p
source leaprc.gaff2

loadamberparams morph.frcmod
# fixme merged here refers to the morphed ligands, ie merged ligands lambda 0 and lambda 13
lig = loadMol2 morph.mol2
protein = LoadPdb protein.pdb
# double curly brackets since we use python's str.format misapplies here
complex = Combine {{lig protein}}
# https://www.cgl.ucsf.edu/chimera/docs/UsersGuide/midas/solvate.html
# https://www.cgl.ucsf.edu/chimera/docs/ContributedSoftware/solvate/solvate.html
solvateoct complex TIP3PBOX 14
# fixme - this should be handled appropriately, ie the software won't understand dual topologies
addIons complex Na+ 0
addIons complex Cl- 0
savepdb complex morph_solv.pdb
saveamberparm complex morph_solv.top morph_solv.crd
quit
